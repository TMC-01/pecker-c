!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.YZMonitor=t()}(this,function(){"use strict";function e(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function t(e,t){return e(t={exports:{}},t.exports),t.exports}var c=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.queryString=function(e){return encodeURIComponent(JSON.stringify(e))}});e(c);c.queryString;var l=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){};t.default=r});e(l);var u=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var r,n,o,a,i,u,s,d={appkey:l.default.appkey,disable:l.default.disable,appVersion:"1.0",records:[]};if(d.disable)switch(t){case"resourceError":(u=d).records=[{type:"resourceError",data:{outerHTML:(s=e).outerHTML,src:s.src,tagName:s.localName.toUpperCase(),occurTime:(new Date).getTime(),title:document.title,url:window.location.href,userAgent:window.navigator.userAgent}}],(new Image).src=l.default.uploadUrl+"?commit="+c.queryString(u);break;case"httpError":i=e,(a=d).records=[{type:"httpError",data:{occurTime:(new Date).getTime(),title:document.title,url:window.location.href,userAgent:window.navigator.userAgent,method:i.method?i.method:"GET",status:i.status,statusText:i.statusText,response:i.response,requestUrl:i.url||i.requestUrl}}],console.log(a),(new Image).src=l.default.uploadUrl+"?commit="+c.queryString(a);break;case"caught":o=e,(n=d).records=[{type:"caughtError",data:{occurTime:(new Date).getTime(),title:document.title,url:window.location.href,userAgent:window.navigator.userAgent,stacktrace:o.stack}}],console.log(n),(new Image).src=l.default.uploadUrl+"?commit="+c.queryString(n);break;case"promise":(r=d).records=[{type:"caughtError",data:{occurTime:(new Date).getTime(),title:document.title,url:window.location.href,userAgent:window.navigator.userAgent,name:"unhandledrejection"}}],console.log(r),(new Image).src=l.default.uploadUrl+"?commit="+c.queryString(r)}}});e(u);var n=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){if(window.addEventListener("unhandledrejection",function(e){e.reason&&e.reason.stack&&u.default(e.reason,"caught")},!1),window.addEventListener("rejectionhandled",function(e){},!0),window.addEventListener("error",function(e){u.default(e.target,"resourceError")},!0),window.XMLHttpRequest){var e,o,t=window.XMLHttpRequest,a=t.prototype.send,r=t.prototype.open,i=function(e,t,r){if(e&&e.currentTarget&&200!==e.currentTarget.status){console.log(e);var n={method:r,status:e.currentTarget.status,statusText:e.currentTarget.statusText,response:-1!=e.currentTarget.response.indexOf("!DOCTYPE html")?"":e.currentTarget.response,requestUrl:t};u.default(n,"httpError")}};t.prototype.open=function(){return o=arguments[0],e=arguments[1],r.apply(this,arguments)},t.prototype.send=function(){var t=e,r=o;if(this.addEventListener)this.addEventListener("error",function(e){i(e,t,r)}),this.addEventListener("timeout",function(e){i(e,t,r)}),this.addEventListener("load",function(e){i(e,t,r)}),this.addEventListener("abort",function(e){i(e,t,r)});else{var n=this.onreadystatechange;this.onreadystatechange=function(e){4===this.readyState&&i(e,t,r),n&&n.apply(this,arguments)}}return a.apply(this,arguments)}}}});e(n);var r=t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function t(){this.getAppkey(),n.default()}return t.notify=function(e){var t=e.name;if(t){var r=e.message,n="caught";if(r){r.split(/[\n,]/g);n=-1!=t.indexOf("http")?"httpError":"caught"}u.default(e,n)}},t.prototype.getAppkey=function(){var e=this;this.timer=setInterval(function(){t.config.appkey&&(l.default.appkey=t.config.appkey,l.default.disable=t.config.disable,l.default.uploadUrl=t.config.uploadUrl,clearInterval(e.timer))},100)},t.config={appkey:"",disable:1,uploadUrl:""},t}();new(t.YZMonitor=r)});e(r);r.YZMonitor;return e(t(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=r.YZMonitor}))});
